async function drawCard({ name, xp, startDate, projectedDate, reached }) {
  const img = await loadImage(reached ? ACHIEVED_CARD_SRC : BASE_CARD_SRC);
  const ctx = canvas.getContext("2d");
  canvas.width = img.width;   // expect 750
  canvas.height = img.height; // expect 1050
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(img, 0, 0);

  // Base design size
  const W = 750, H = 1050, sx = canvas.width / W, sy = canvas.height / H;
  const scaled = (x, y) => [x * sx, y * sy];
  const setFont = (w, weight=700) =>
    ctx.font = `${weight} ${Math.round(w * sx)}px system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif`;

  ctx.textBaseline = "top";
  ctx.shadowColor = "rgba(0,0,0,.55)";
  ctx.shadowBlur = 4;
  ctx.shadowOffsetY = 1;

  // ===== Trainer Name (same spot, tiny smaller, auto-fit to 15 chars) =====
  ctx.fillStyle = "#ffffff";
  const nameText = (name || "Trainer").slice(0, 15);
  let [nx, ny] = scaled(60, 86);                // keep position
  ctx.textAlign = "left";
  // max width ~banner width under the tape
  const nameMaxW = Math.round(560 * sx);
  // base size a touch smaller than before (was 54)
  drawFittedText(ctx, nameText, Math.round(52 * sx), nameMaxW, nx, ny, 800);

  // ===== Start Date (slightly higher from earlier fix) =====
  setFont(30, 800);
  ctx.textAlign = "right";
  let [sdx, sdy] = scaled(690, 98);
  ctx.fillText(fmtDateMDY(startDate), sdx, sdy);

  // ===== XP (tiny smaller + tiny higher; auto-fit up to 4,000,000,000) =====
  ctx.textAlign = "left";
  ctx.fillStyle = "#ffffff";
  const [xx, xy] = scaled(70, 820);             // was 840 â†’ nudge up
  const xpText = fmtXP(xp);
  const xpMaxW = canvas.width - xx - Math.round(40 * sx);
  // base size a touch smaller than before (was ~100)
  drawFittedText(ctx, xpText, Math.round(92 * sx), xpMaxW, xx, xy, 900);

  // ===== Projected Date (only on base/blue card) =====
  if (!reached) {
    setFont(96, 900);
    ctx.fillStyle = "#ff2a2a";
    let [px, py] = scaled(70, 300);
    ctx.fillText(fmtDateMDY(projectedDate), px, py);
  }

  dl.href = canvas.toDataURL("image/png");
}
